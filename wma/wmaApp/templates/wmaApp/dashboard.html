{% extends 'wmaApp/baseIndex.html' %}
{% load static %}
{% block title %}
<title>Dashboard</title>
{% endblock %}
{% block css %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>

<style>
    /* General Dashboard Card Styling */
    .dashboard-card {
        border-radius: 1rem !important;
        color: #fff !important;
        box-shadow: 0 6px 16px rgba(0,0,0,0.15) !important;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .dashboard-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 24px rgba(0,0,0,0.25) !important;
    }

    /* Make all text readable */
    .dashboard-card .header,
    .dashboard-card .meta,
    .dashboard-card .description,
    .dashboard-card .content,
    .dashboard-card i.icon {
        color: #fff !important;
    }

    .dashboard-card .header.count {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 0.3rem;
    }
    .dashboard-card .meta {
        font-size: 1rem;
        font-weight: 500;
        opacity: 0.9;
    }
    .dashboard-card .description {
        font-size: 0.9rem;
        opacity: 0.85;
    }
    .dashboard-card i.icon {
        font-size: 2.5rem;
        opacity: 0.95;
    }

    /* Gradient Backgrounds */
    .red-card { background: linear-gradient(135deg, #ff416c, #ff4b2b)!important; }
    .green-card { background: linear-gradient(135deg, #11998e, #38ef7d)!important;; }
    .teal-card { background: linear-gradient(135deg, #06beb6, #48b1bf)!important;; }
    .purple-card { background: linear-gradient(135deg, #8e2de2, #4a00e0)!important;; }
    .orange-card { background: linear-gradient(135deg, #f7971e, #ffd200)!important;; }
    .pink-card {
        background: linear-gradient(135deg, #ff758c, #ff7eb3) !important;
    }
        .navy-card {
            background: linear-gradient(135deg, #193038, #2a4d5a) !important;
            color: #fff;
        }
    .gold-card {
        background: linear-gradient(135deg, #d4af37, #fceabb) !important;
        color: #333;
    }
    .grape-card {
        background: linear-gradient(135deg, #41295a, #2f0743) !important;
        color: #fff;
    }
    .lime-card {
        background: linear-gradient(135deg, #a8e063, #56ab2f) !important;
        color: #fff;
    }
    /* Button tweaks */
    .ui.button {
        border-radius: 2rem !important;
        font-weight: 600 !important;
    }

    /* Mobile Spacing */
    @media(max-width: 768px) {
        .dashboard-card {
            margin-bottom: 1rem !important;
        }
    }
    .dashboard-card .ui.button {
        border-radius: 2rem !important;
        font-weight: 600 !important;
        color: #fff !important;          /* Ensure button text is visible */
    }
</style>
{% endblock %}
{% block body %}
<div class="ui left aligned basic  grid">
    <div class="sixteen wide column">
        <div class="ui  pointing secondary menu">
            <div style="cursor: pointer;" class="item active" data-tab="user"
            >Dashboard
            </div>
        </div>
        <div class="ui tab " data-tab="user">

            <div class="ui grid stackable padded">
                <!-- Total Parties -->
                <div class="four wide computer eight wide tablet sixteen wide mobile column">
                    <div class="ui fluid card dashboard-card red-card">
                        <div class="content">
                            <div class="ui right floated header">
                                <i class="users icon"></i>
                            </div>
                            <div class="header" id="customerCount">{{total_customers}}</div>
                            <div class="meta">Total Customers</div>
                            <div class="description">Total number of Customers.</div>
                        </div>
                        <div class="extra content">
                            <a class="ui inverted red button fluid" href="{% url 'wmaApp:manage_customer' %}">More Info</a>
                        </div>
                    </div>
                </div>

                <!-- Total Users -->
                <div class="four wide computer eight wide tablet sixteen wide mobile column">
                    <div class="ui fluid card dashboard-card green-card">
                        <div class="content">
                            <div class="ui right floated header">
                                <i class="user tie icon"></i>
                            </div>
                            <div class="header" id="staffCount">{{total_staff}}</div>
                            <div class="meta">Total Users</div>
                            <div class="description">Total number of Staff users.</div>
                        </div>
                        <div class="extra content">
                            <a class="ui inverted green button fluid" href="{% url 'wmaApp:manage_staff' %}">More Info</a>
                        </div>
                    </div>
                </div>

                <!-- Geolocation -->
                <div class="four wide computer eight wide tablet sixteen wide mobile column">
                    <div class="ui fluid card dashboard-card teal-card">
                        <div class="content">
                            <div class="ui right floated header">
                                <i class="map marker alternate icon"></i>
                            </div>
                            <div class="header" id="location">{{total_locations}}</div>
                            <div class="meta">Locations</div>
                            <div class="description">Number of location service used.</div>
                        </div>
                        <div class="extra content">
                            <a class="ui inverted teal button fluid" href="{% url 'wmaApp:manage_location' %}">More Info</a>
                        </div>
                    </div>
                </div>
                <div class="four wide computer eight wide tablet sixteen wide mobile column">
                    <div class="ui fluid card dashboard-card pink-card">
                        <div class="content">
                            <div class="ui right floated header">
                                <i class="truck icon"></i>
                            </div>
                            <div class="header" id="jars"><span><span>{{jars_in}}</span> IN </span> -- <span>{{jars_out}}<span></span> OUT</span></div>
                            <div class="meta">Today's Jars Count</div>
                            <div class="description">Total numbers of Jars In and Out.</div>
                        </div>
                        <div class="extra content">
                            <a class="ui inverted pink button fluid" href="{% url 'wmaApp:manage_jars' %}">More Info</a>
                        </div>
                    </div>
                </div>

                <!-- Collections -->
                <div class="four wide computer eight wide tablet sixteen wide mobile column">
                    <div class="ui fluid card dashboard-card purple-card">
                        <div class="content">
                            <div class="ui right floated header">
                                <i class="hand holding usd icon"></i>
                            </div>
                            <div class="header" id="collection">₹ {{payments_today}}</div>
                            <div class="meta">Today's Collection</div>
                            <div class="description">Total amount of collections.</div>
                        </div>
                        <div class="extra content">
                            <a class="ui inverted purple button fluid" href="{% url 'wmaApp:manage_payments' %}">More Info</a>
                        </div>
                    </div>
                </div>

                <!-- Sales -->
                <div class="four wide computer eight wide tablet sixteen wide mobile column">
                    <div class="ui fluid card dashboard-card orange-card">
                        <div class="content">
                            <div class="ui right floated header">
                                <i class="coins icon"></i>
                            </div>
                            <div class="header" id="expense">₹ {{total_expense}}</div>
                            <div class="meta">Today's Expenses</div>
                            <div class="description">Total amount of expenses.</div>
                        </div>
                        <div class="extra content">
                            <a class="ui inverted orange button fluid" href="{% url 'wmaApp:manage_expense' %}">More Info</a>
                        </div>
                    </div>
                </div>
                <div class="four wide computer eight wide tablet sixteen wide mobile column">
                    <div class="ui fluid card dashboard-card lime-card">
                        <div class="content">
                            <div class="ui right floated header">
                                <i class="receipt icon"></i>
                            </div>
                            <div class="header" id="sale"> ₹ {{total_sales}}</div>
                            <div class="meta">Today's Sales</div>
                            <div class="description">Total amount of sales.</div>
                        </div>
                        <div class="extra content">
                            <a class="ui inverted yellow button fluid" href="{% url 'wmaApp:manage_sale' %}">More Info</a>
                        </div>
                    </div>
                </div>

                <div class="eight wide computer eight wide tablet sixteen wide mobile column">
                    <div class="ui segment chart-card">
                        <h5>OVERVIEW</h5>
                        <h3>Sales value for past 7 days</h3>
                        <div class="chart-wrap">
                            <canvas id="salesChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="eight wide computer eight wide tablet sixteen wide mobile column">
                    <div class="ui segment chart-card">
                        <h5>PERFORMANCE</h5>
                        <h3>Payments value for past 7 days</h3>
                        <div class="chart-wrap">
                            <canvas id="ordersChart"></canvas>
                        </div>
                    </div>
                </div>


            </div>


            </div>
    </div>
</div>
{% endblock %}

{% block js %}

<script>
    $(function() {
        // Initialize all progress bars
        $('.progress').progress({ showActivity:false, limitValues:true });

        // Charts config
        const chartOpts = {
            responsive: true, maintainAspectRatio: true, aspectRatio: 2.1,
            plugins: {
                legend: { display: true }
            },
            scales: {
                x: { grid: { display: false } },
                y: { beginAtZero: true, ticks: { stepSize: 10, precision: 0 } }
            }
        };
        // Sales Line Chart
        var x ={{sales_totals_by_date|safe}};
        var y = {{sales_date|safe}};
        new Chart(document.getElementById('salesChart'), {
            type: 'line',
            data: {
                labels: y,
                datasets: [{
                    label: 'Sales',
                    data: x,
                    borderColor: '#4a00e0',
                    backgroundColor: 'rgba(74,0,224,0.10)',
                    fill: true,
                    tension: 0.45,
                    pointRadius: 0
                }]
            },
            options: chartOpts
        });
        // Orders Bar Chart
        var a ={{payment_totals_by_date|safe}};
        var b = {{sales_date|safe}};
        new Chart(document.getElementById('ordersChart'), {
            type: 'bar',
            data: {
                labels: b,
                datasets: [{
                    label: 'Payments',
                    data: a,
                    backgroundColor: '#ff4b2b',
                    borderRadius: 9
                }]
            },
            options: chartOpts
        });
    });
</script>
{% endblock %}

